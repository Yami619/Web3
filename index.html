<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ™‰ğŸ™‰ å£¯å£¯ å°ˆæ³¨åŠ›ï¼†è¨˜æ†¶åŠ›è¨“ç·´ï½œç²‰è‰²ç‰ˆï½œé€²éšè¨ˆæ™‚æŒ‘æˆ°</title>
<style>
*{
    margin:0;
    padding:0;
    box-sizing:border-box;
    font-family:å¾®è»Ÿæ­£é»‘é«”, sans-serif;
}
/* æ•´é«”ç²‰è‰²èƒŒæ™¯ */
body{
    background:#fff5f7;
    padding:15px;
    text-align:center;
}
.title{
    font-size:24px;
    color:#d65a8a;
    margin:15px 0;
    font-weight:bold;
}
.level-info{
    font-size:17px;
    color:#c2507d;
    margin:8px 0;
}
.step-info{
    font-size:16px;
    color:#c2507d;
    margin:8px 0;
}
.time-info{
    font-size:16px;
    color:#d65a8a;
    margin:8px 0;
    font-weight:bold;
}
/* è¨“ç·´èªªæ˜ç²‰è‰²æ¡† */
.desc-box{
    max-width:380px;
    margin:12px auto;
    padding:10px;
    font-size:15px;
    color:#a8446b;
    line-height:1.6;
    text-align:left;
    background:#fef1f5;
    border:1px solid #f8d7e4;
    border-radius:6px;
}
/* éŠæˆ²å¡ç‰‡æ’ç‰ˆ */
.game-box{
    display:grid;
    gap:8px;
    justify-content:center;
    margin:20px auto;
    max-width:95%;
}
.lv1{ grid-template-columns: repeat(3, 80px); }
.lv2{ grid-template-columns: repeat(4, 78px); }
.lv3{ grid-template-columns: repeat(5, 75px); }
.lv4{ grid-template-columns: repeat(4, 75px); }
.lv5{ grid-template-columns: repeat(4, 72px); }
.lv6{ grid-template-columns: repeat(4, 70px); }
.lv7{ grid-template-columns: repeat(5, 68px); }
.lv8{ grid-template-columns: repeat(5, 66px); }
.lv9{ grid-template-columns: repeat(5, 64px); }
.lv10{ grid-template-columns: repeat(6, 62px); }
.lv11{ grid-template-columns: repeat(6, 60px); }
.lv12{ grid-template-columns: repeat(6, 58px); }
.lv13{ grid-template-columns: repeat(7, 56px); }
.lv14{ grid-template-columns: repeat(7, 54px); }
.lv15{ grid-template-columns: repeat(7, 52px); }
.lv16{ grid-template-columns: repeat(8, 50px); }
.lv17{ grid-template-columns: repeat(8, 48px); }
.lv18{ grid-template-columns: repeat(8, 46px); }
.lv19{ grid-template-columns: repeat(8, 44px); }
.lv20{ grid-template-columns: repeat(8, 42px); }

/* å¡ç‰‡ç²‰è‰²æ¨£å¼ */
.card{
    width:100%;
    aspect-ratio:1/1;
    background:#f8d7e4;
    border-radius:8px;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:24px;
    font-weight:bold;
    color:#222;
    cursor:pointer;
    transition:0.2s;
    user-select:none;
}
.card.flipped{
    background:#ffffff;
    pointer-events:none;
}
.card.matched{
    background:#fce4ec;
    pointer-events:none;
}
/* æŒ‰éˆ•ç²‰è‰² */
.btn{
    padding:10px 22px;
    background:#e9719c;
    color:#fff;
    border:none;
    border-radius:8px;
    font-size:15px;
    margin:10px 5px;
    cursor:pointer;
}
/* æ¯é—œç¿»ç‰Œæ¬¡æ•¸çµ±è¨ˆ */
.stats-box{
    max-width:380px;
    margin:20px auto;
    padding:12px;
    font-size:15px;
    color:#a8446b;
    line-height:1.6;
    text-align:left;
    background:#fef1f5;
    border:1px solid #f8d7e4;
    border-radius:6px;
}
.stats-title{
    font-weight:bold;
    margin-bottom:8px;
    text-align:center;
}
.stats-list{
    display:grid;
    grid-template-columns: repeat(2, 1fr);
    gap:5px;
}
</style>
</head>
<body>

<div class="title">20é—œå°ˆæ³¨è¨“ç·´</div>
<div class="level-info">
    é—œå¡ï¼š<span id="level">1</span> / 20
</div>
<div class="step-info">
    ç¿»ç‰Œæ¬¡æ•¸ï¼š<span id="step">0</span>
</div>
<div class="time-info" id="timeInfo" style="display:none;">
    å‰©é¤˜æ™‚é–“ï¼š<span id="timeLeft">0</span> ç§’
</div>

<!-- è¨“ç·´æ–¹å¼èªªæ˜ + é˜²ä½œå¼Šè¦å‰‡ -->
<div class="desc-box">
    è¨“ç·´æ–¹å¼ï¼š<br>
    1. å°ˆå¿ƒè¨˜ä½æ¯å¼µå¡ç‰‡çš„åœ–æ¡ˆèˆ‡ä½ç½®<br>
    2. é»æ“Šç¿»ç‰Œï¼Œæ‰¾å‡ºç›¸åŒåœ–æ¡ˆé…å°<br>
    3. å®Œæˆä¸€é—œè‡ªå‹•è§£é–ä¸‹ä¸€é—œï¼Œ20é—œå…¨ç ´è¨“ç·´æˆåŠŸ<br>
    4. 1-10é—œä½¿ç”¨æ•¸å­—é¡è‰²é…å°ï¼Œ11-20é—œé–‹å•Ÿè¨ˆæ™‚æŒ‘æˆ°æ¨¡å¼ï¼Œè¨“ç·´é€Ÿåº¦ <br>
    5. æœ¬è¨“ç·´å·²ç”Ÿæˆå°ˆå±¬4ç¢¼è‹±æ–‡+æ•¸å­—ï¼Œè‹¥é‡æ–°æ•´ç†æˆ–æ›´æ›é é¢ï¼Œç·¨ç¢¼æœƒæ”¹è®Šï¼Œæ–¹ä¾¿è¾¨è­˜ä½œå¼Š
</div>

<!-- é˜²ä½œå¼Š 4 ç¢¼é¡¯ç¤º -->
<div style="margin:10px 0; font-size:16px; color:#d65a87;">
æœ¬æ¬¡è¨“ç·´ç·¨ç¢¼ï¼š<span id="secretCode" style="font-weight:bold; letter-spacing:2px;"></span>
</div>

<div id="gameBox" class="game-box"></div>

<button class="btn" onclick="checkResetPassword()">é‡æ–°é–‹å§‹</button>

<!-- æ¯é—œç¿»ç‰Œæ¬¡æ•¸çµ±è¨ˆ -->
<div class="stats-box">
    <div class="stats-title">æ¯é—œç¿»ç‰Œæ¬¡æ•¸çµ±è¨ˆ</div>
    <div class="stats-list" id="statsList"></div>
</div>

<script>
// ç”Ÿæˆä¸€æ¬¡å›ºå®š 4 ç¢¼è‹±æ–‡+æ•¸å­—ï¼ˆé˜²é‡æ–°æ•´ç†ï¼‰
function generateSecretCode() {
    const chars = 'ABCDEFGHJKLMNPQRSTWXYZ23456789';
    let code = '';
    for (let i = 0; i < 4; i++) {
        code += chars[Math.floor(Math.random() * chars.length)];
    }
    return code;
}

// é é¢ä¸€è¼‰å…¥å°±ç”Ÿæˆ
const secretCode = generateSecretCode();
document.getElementById('secretCode').innerText = secretCode;

// 20é—œé›£åº¦è¨­å®šï¼ˆ11-20é—œé–‹å•Ÿè¨ˆæ™‚ï¼‰
const levelConfig = [
  { pairs:3, grid:'lv1', time:0 },    // 1
  { pairs:4, grid:'lv2', time:0 },    // 2
  { pairs:5, grid:'lv3', time:0 },    // 3
  { pairs:6, grid:'lv4', time:0 },    // 4
  { pairs:7, grid:'lv5', time:0 },    // 5
  { pairs:8, grid:'lv6', time:0 },    // 6
  { pairs:9, grid:'lv7', time:0 },    // 7
  { pairs:10, grid:'lv8', time:0 },   // 8
  { pairs:11, grid:'lv9', time:0 },   // 9
  { pairs:12, grid:'lv10', time:0 },  // 10
  { pairs:13, grid:'lv11', time:60 }, // 11 - è¨ˆæ™‚60ç§’
  { pairs:14, grid:'lv12', time:60 }, // 12 - è¨ˆæ™‚60ç§’
  { pairs:15, grid:'lv13', time:55 }, // 13 - è¨ˆæ™‚55ç§’
  { pairs:16, grid:'lv14', time:55 }, // 14 - è¨ˆæ™‚55ç§’
  { pairs:17, grid:'lv15', time:50 }, // 15 - è¨ˆæ™‚50ç§’
  { pairs:18, grid:'lv16', time:50 }, // 16 - è¨ˆæ™‚50ç§’
  { pairs:19, grid:'lv17', time:45 }, // 17 - è¨ˆæ™‚45ç§’
  { pairs:20, grid:'lv18', time:45 }, // 18 - è¨ˆæ™‚45ç§’
  { pairs:21, grid:'lv19', time:40 }, // 19 - è¨ˆæ™‚40ç§’
  { pairs:22, grid:'lv20', time:40 }  // 20 - è¨ˆæ™‚40ç§’
];

// æ•¸å­—é¡è‰²åˆ—è¡¨ï¼ˆ1-10é—œä½¿ç”¨ï¼‰
const colorList = ["#ff4444","#00C851","#33b5e5","#ffbb33","#aa66cc","#ff8800","#0099cc","#99cc00","#ff4444","#33b5e5","#aa66cc","#ff8800"];
const numberPool = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24];

// å…’ç«¥å‹å¥½åœ–æ¡ˆåº«ï¼ˆ11-20é—œä½¿ç”¨ï¼‰
const iconPool = [
    'ğŸ¶','ğŸ±','ğŸ­','ğŸ¹','ğŸ°','ğŸ¦Š','ğŸ»','ğŸ¼',
    'ğŸ¨','ğŸ¯','ğŸ¦','ğŸ®','ğŸ·','ğŸ¸','ğŸµ','ğŸ”',
    'ğŸ§','ğŸ¦','ğŸ¤','ğŸ¦†','ğŸ¦…','ğŸ¦‰','ğŸ¦‡','ğŸº'
];

let currentLevel = 1;
let cards = [];
let flipped = [];
let matched = 0;
let steps = 0;
let levelSteps = Array(20).fill(0); // è¨˜éŒ„æ¯é—œç¿»ç‰Œæ¬¡æ•¸
let timeLeft = 0;
let timerInterval = null;

function startGame(){
  const config = levelConfig[currentLevel-1];
  document.getElementById('level').innerText = currentLevel;
  document.getElementById('step').innerText = '0';

  // è™•ç†è¨ˆæ™‚æ¨¡å¼
  if(config.time > 0){
    timeLeft = config.time;
    document.getElementById('timeInfo').style.display = 'block';
    document.getElementById('timeLeft').innerText = timeLeft;
    startTimer();
  } else {
    document.getElementById('timeInfo').style.display = 'none';
    if(timerInterval) clearInterval(timerInterval);
  }

  const box = document.getElementById('gameBox');
  box.className = 'game-box ' + config.grid;
  box.innerHTML = '';

  cards = [];
  flipped = [];
  matched = 0;
  steps = 0;

  let pairList = [];
  if(currentLevel <= 10){
    // 1-10é—œï¼šæ•¸å­—+é¡è‰²
    for(let i=0;i<config.pairs;i++){
      pairList.push(numberPool[i]);
      pairList.push(numberPool[i]);
    }
    pairList = pairList.sort(()=>Math.random()-0.5);
    pairList.forEach(num=>{
      const card = document.createElement('div');
      card.className = 'card';
      card.dataset.num = num;
      card.onclick = ()=>flipCard(card);
      box.appendChild(card);
      cards.push(card);
    });
  } else {
    // 11-20é—œï¼šå…’ç«¥åœ–æ¡ˆ
    for(let i=0;i<config.pairs;i++){
      pairList.push(iconPool[i]);
      pairList.push(iconPool[i]);
    }
    pairList = pairList.sort(()=>Math.random()-0.5);
    pairList.forEach(icon=>{
      const card = document.createElement('div');
      card.className = 'card';
      card.dataset.icon = icon;
      card.onclick = ()=>flipCard(card);
      box.appendChild(card);
      cards.push(card);
    });
  }

  updateStatsDisplay(); // æ›´æ–°çµ±è¨ˆé¡¯ç¤º
}

function startTimer(){
  if(timerInterval) clearInterval(timerInterval);
  timerInterval = setInterval(()=>{
    timeLeft--;
    document.getElementById('timeLeft').innerText = timeLeft;
    if(timeLeft <= 0){
      clearInterval(timerInterval);
      alert('æ™‚é–“åˆ°ï¼æœ¬é—œæŒ‘æˆ°å¤±æ•—ï¼Œè«‹é‡æ–°å˜—è©¦');
      startGame(); // é‡æ–°é–‹å§‹æœ¬é—œ
    }
  }, 1000);
}

function flipCard(card){
  if(flipped.length >=2) return;
  if(card.classList.contains('flipped')) return;

  if(currentLevel <= 10){
    // 1-10é—œï¼šæ•¸å­—+é¡è‰²
    const num = parseInt(card.dataset.num);
    card.classList.add('flipped');
    card.innerText = num;
    card.style.color = colorList[(num-1) % colorList.length];
  } else {
    // 11-20é—œï¼šå…’ç«¥åœ–æ¡ˆ
    const icon = card.dataset.icon;
    card.classList.add('flipped');
    card.innerText = icon;
  }

  flipped.push(card);
  steps++;
  document.getElementById('step').innerText = steps;

  if(flipped.length ===2){
    setTimeout(checkMatch,500);
  }
}

function checkMatch(){
  const [a,b] = flipped;
  if(currentLevel <= 10){
    if(a.dataset.num === b.dataset.num){
      a.classList.add('matched');
      b.classList.add('matched');
      matched +=2;
    } else {
      a.classList.remove('flipped');
      b.classList.remove('flipped');
      a.innerText = '';
      b.innerText = '';
    }
  } else {
    if(a.dataset.icon === b.dataset.icon){
      a.classList.add('matched');
      b.classList.add('matched');
      matched +=2;
    } else {
      a.classList.remove('flipped');
      b.classList.remove('flipped');
      a.innerText = '';
      b.innerText = '';
    }
  }

  const total = levelConfig[currentLevel-1].pairs *2;
  if(matched === total){
    levelSteps[currentLevel-1] = steps; // è¨˜éŒ„æœ¬é—œç¿»ç‰Œæ¬¡æ•¸
    if(timerInterval) clearInterval(timerInterval);
    setTimeout(()=>{
      if(currentLevel < 20){
        alert(`å®Œæˆç¬¬${currentLevel}é—œï¼Œè‡ªå‹•é€²å…¥ç¬¬${currentLevel+1}é—œ`);
        currentLevel++;
        startGame();
      }else{
        alert("ğŸ‰ 20é—œå…¨éƒ¨å®Œæˆï¼å°ˆæ³¨åŠ›è¨“ç·´æˆåŠŸï¼");
        updateStatsDisplay(); // å®Œæˆå¾Œæ›´æ–°çµ±è¨ˆ
      }
    },300);
  }
  flipped = [];
}

// æ›´æ–°çµ±è¨ˆé¡¯ç¤º
function updateStatsDisplay() {
  const statsList = document.getElementById('statsList');
  statsList.innerHTML = '';
  for(let i=0; i<20; i++){
    const statItem = document.createElement('div');
    statItem.textContent = `ç¬¬${i+1}é—œï¼š${levelSteps[i]}æ¬¡`;
    if(levelSteps[i] > 0){
      statItem.style.color = '#d65a8a';
      statItem.style.fontWeight = 'bold';
    }
    statsList.appendChild(statItem);
  }
}

// é‡æ–°é–‹å§‹å¯†ç¢¼é©—è­‰
function checkResetPassword(){
  let input = prompt("è«‹è¼¸å…¥é‡æ–°é–‹å§‹å¯†ç¢¼ï¼š");
  if(input === null) return;
  if(input == "787831"){
    resetAll();
    alert("å¯†ç¢¼æ­£ç¢ºï¼Œå·²é‡æ–°é–‹å§‹ï¼");
  }else{
    alert("å¯†ç¢¼éŒ¯èª¤ï¼Œç„¡æ³•é‡æ–°é–‹å§‹ï¼");
  }
}

function resetAll(){
  currentLevel = 1;
  levelSteps = Array(20).fill(0); // é‡ç½®çµ±è¨ˆ
  if(timerInterval) clearInterval(timerInterval);
  startGame();
}

window.onload = startGame;
</script>
</body>
</html>
